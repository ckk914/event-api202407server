
## ë„ì»¤ ì»´í¬ì¦ˆ ì„¤ì¹˜
ë„ì»¤ ì»´í¬ì¦ˆëŠ” ì—¬ëŸ¬ ì»¨í…Œì´ë„ˆë¡œ êµ¬ì„±ëœ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì •ì˜í•˜ê³  ì‹¤í–‰í•˜ê¸° ìœ„í•œ ë„êµ¬ì…ë‹ˆë‹¤. 

ì´ë¥¼ ì‚¬ìš©í•˜ë©´ YAML íŒŒì¼(docker-compose.yml)ì„ í†µí•´ ì„œë¹„ìŠ¤, ë„¤íŠ¸ì›Œí¬, ë³¼ë¥¨ ë“±ì„ êµ¬ì„±í•˜ê³  ê´€ë¦¬í•  ìˆ˜ ìˆì–´ 
ë³µì¡í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‰½ê²Œ ë°°í¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ë„ì»¤ ì»´í¬ì¦ˆëŠ” Docker Desktopì— í¬í•¨ë˜ì–´ ìˆìœ¼ë¯€ë¡œ ë³„ë„ ì„¤ì¹˜ê°€ í•„ìš” ì—†ìŠµë‹ˆë‹¤.

## ê¸°ë³¸ ëª…ë ¹ì–´

- `docker compose up`: ë„ì»¤ ì»´í¬ì¦ˆ íŒŒì¼ì„ ì‚¬ìš©í•˜ì—¬ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹œì‘í•©ë‹ˆë‹¤.

- `docker compose down`: ì‹¤í–‰ ì¤‘ì¸ ì„œë¹„ìŠ¤ë¥¼ ì¤‘ì§€í•˜ê³  ê´€ë ¨ ë¦¬ì†ŒìŠ¤ë¥¼ ì œê±°í•©ë‹ˆë‹¤.

- `docker compose ps`: ë„ì»¤ ì»´í¬ì¦ˆë¡œ ê´€ë¦¬ë˜ëŠ” ì»¨í…Œì´ë„ˆì˜ ìƒíƒœë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤.



```dtd
 kon@konui-MacBookAir î‚° ~/konFolder/src/javaProject/event.api î‚° î‚  main Â±âœš î‚° docker compose up -d
[+] Running 9/9
 âœ” db Pulled                                                                                                                                                                               97.8s
   âœ” 4ce000a43472 Pull complete                                                                                                                                                            51.7s
   âœ” 22e52f551a69 Pull complete                                                                                                                                                            51.7s
   âœ” ca381c353a6d Pull complete                                                                                                                                                            52.0s
   âœ” 3828f5d4474e Pull complete                                                                                                                                                            52.0s
   âœ” cffe4cfab7a4 Pull complete                                                                                                                                                            52.0s
   âœ” 73b3f7bc1876 Pull complete                                                                                                                                                            87.3s
   âœ” 9397b4e36b82 Pull complete                                                                                                                                                            87.3s
   âœ” 3ed81bb82143 Pull complete                                                                                                                                                            87.4s
[+] Building 177.0s (12/12) FINISHED                                                                                                                                        docker:desktop-linux
 => [app internal] load build definition from Dockerfile                                                                                                                                    0.0s
 => => transferring dockerfile: 532B                                                                                                                                                        0.0s
 => [app internal] load metadata for docker.io/library/amazoncorretto:11                                                                                                                    1.6s
 => [app auth] library/amazoncorretto:pull token for registry-1.docker.io                                                                                                                   0.0s
 => [app internal] load .dockerignore                                                                                                                                                       0.0s
 => => transferring context: 2B                                                                                                                                                             0.0s
 => [app 1/5] FROM docker.io/library/amazoncorretto:11@sha256:338fa93eef2e155bb8567a5c0a2cd67dfe52d575db833a926a503d728605408d                                                              0.0s
 => [app internal] load build context                                                                                                                                                       0.5s
 => => transferring context: 54.12MB                                                                                                                                                        0.5s
 => CACHED [app 2/5] WORKDIR /app                                                                                                                                                           0.0s
 => [app 3/5] COPY . /app                                                                                                                                                                   0.4s
 => [app 4/5] RUN ./gradlew clean build                                                                                                                                                   173.6s
 => [app 5/5] RUN cp build/libs/*.jar app.jar                                                                                                                                               0.3s
 => [app] exporting to image                                                                                                                                                                0.6s
 => => exporting layers                                                                                                                                                                     0.6s
 => => writing image sha256:768ec6f4d7e23fb97c954c0465d693cf96c9b0afc0a83835f2fd9cc1c3f06d82                                                                                                0.0s
 => => naming to docker.io/library/eventapi-app                                                                                                                                             0.0s
 => [app] resolving provenance for metadata file                                                                                                                                            0.0s
[+] Running 4/4
 âœ” Network eventapi_default   Created                                                                                                                                                       0.0s
 âœ” Volume "eventapi_db-data"  Created                                                                                                                                                       0.0s
 âœ” Container eventapi-db-1    Started                                                                                                                                                       0.3s
 âœ” Container eventapi-app-1   Started                                                                                                                                                       0.3s
 kon@konui-MacBookAir î‚° ~/konFolder/src/javaProject/event.api î‚° î‚  main Â±âœš î‚°

```

### ğŸ‘½ ë„ì»¤íŒŒì¼, ë„ì»¤ ì»´í¬ì¦ˆ íŒŒì¼ ë§Œë“¤ê¸°~!
touch Dockerfile
touch docker-compose.yml

docker build -t spring-image .    //ë¹Œë“œ 

docker compose up -d                : ì´ë¯¸ì§€ ì—†ê³  ì»¨í…Œì´ë„ˆ ì‹¤í–‰ ì—†ëŠ” ìƒíƒœì—ì„œ (-d : ë°±ê·¸ë¼ìš´ë“œ ì‹¤í–‰)
docker compose up -d --build   : ì´ë¯¸ì§€ ìˆëŠ”ë° ì¬ë¹Œë“œ í•˜ê³  ì‹¶ì„ë•Œ ì“°ëŠ” ê²ƒ

Dockerfile
```dtd
# ê¸°ë³¸ ì´ë¯¸ì§€ë¡œ OpenJDKê°€ ì„¤ì¹˜ëœ Amazon Corretto 11 ì‚¬ìš©
#openJDK ë¼ê³  ì³ë„ ì•Œì•„ì„œ ê°€ì ¸ì˜¬ ìˆ˜ ìˆìŒ
FROM amazoncorretto:11

# ì‘ì—… ë””ë ‰í† ë¦¬ ì„¤ì •
WORKDIR /app

# í˜¸ìŠ¤íŠ¸ì˜ Gradle ë˜í¼ì™€ ì†ŒìŠ¤ ì½”ë“œë¥¼ ì´ë¯¸ì§€ë¡œ ë³µì‚¬
COPY . /app

# ì• í”Œë¦¬ì¼€ì´ì…˜ ë¹Œë“œ
RUN ./gradlew clean build

# ë¹Œë“œëœ JAR íŒŒì¼ ë³µì‚¬
RUN cp build/libs/*.jar app.jar

# ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹¤í–‰ ëª…ë ¹
CMD ["java", "-jar", "app.jar"]
```
docker-compose.yml
```dtd

services:
    backend:     # ì´ë¦„ì€ ë‚´ê°€ ì§“ëŠ”ê±°ì„.
        build: .     #ë¹Œë“œí•˜ë¼ëŠ” ì˜ë¯¸
        ports:
            - "80:80"
        depends_on:     #ì´ ì´ë¯¸ì§€ëŠ” ì•„ë˜ì˜ db:    ì˜ì¡´í•˜ê³  ìˆë‹¤
            - db
        environment:      
            SPRING_PROFILES_ACTIVE: 'docker'
            SPRING_DATASOURCE_URL: jdbc:mariadb://db:3306/spring7
            SPRING_DATASOURCE_USERNAME: root
            SPRING_DATASOURCE_PASSWORD: abc1234

    db:
        image: mariadb:10        #ë„ì»¤ í—ˆë¸Œì—ì„œ í’€ ë°›ì•„ì„œ ì“°ëŠ” ê²ƒ
        environment:
            MYSQL_ROOT_PASSWORD: abc1234       # ë£¨íŠ¸ë¹„ë²ˆ ì„¤ì •
            MYSQL_DATABASE: spring7
        volumes:
            - db-data:/var/lib/mysql      # ì €ì¥ê²½ë¡œ
volumes:
    db-data:
```

application.properties ë‚˜ ymlì€
ì ‘ë‘ì–´ë§Œ ê°™ê²Œ ë³µì œí•´ì„œ ì‚¬ìš© ê°€ëŠ¥
application-dev.properties
